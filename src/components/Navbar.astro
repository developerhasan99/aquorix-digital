---
import { Image } from "astro:assets";
import logo from "../assets/aquorix-digital-logo.svg";
---

<nav class="fixed top-6 left-1/2 -translate-x-1/2 z-50 w-[90%] max-w-276">
  <div
    class="glass-nav px-4 py-3 flex items-center justify-between rounded-2xl relative z-50"
  >
    <div class="flex items-center gap-2">
      <a href="/" class="text-xl font-display font-bold tracking-tight">
        <Image src={logo} alt="Aquorix Digital" class="h-9 w-auto" />
      </a>
    </div>

    <div
      class="hidden md:flex items-center gap-10 text-xs font-bold uppercase tracking-widest text-white/50"
    >
      <a href="/#about" class="hover:text-white transition-colors">About</a>
      <a href="/#services" class="hover:text-white transition-colors"
        >Services</a
      >
      <a href="/#portfolio" class="hover:text-white transition-colors">Works</a>
      <a href="/blog" class="hover:text-white transition-colors">Blog</a>
    </div>

    <div class="flex items-center gap-4">
      <a
        href="/#contact"
        class="hidden sm:block px-6 py-2.5 rounded-full bg-accent text-background text-xs font-black uppercase tracking-widest hover:brightness-110 transition-all duration-300"
      >
        Let's Talk
      </a>

      <!-- Mobile Toggle -->
      <button
        id="menu-toggle"
        class="md:hidden w-10 h-10 flex flex-col items-center justify-center gap-1.5 focus:outline-none group"
        aria-label="Toggle Menu"
      >
        <span
          class="w-6 h-0.5 bg-white transition-all duration-300 group-[.active]:rotate-45 group-[.active]:translate-y-2"
        ></span>
        <span
          class="w-6 h-0.5 bg-white transition-all duration-300 group-[.active]:opacity-0"
        ></span>
        <span
          class="w-6 h-0.5 bg-white transition-all duration-300 group-[.active]:-rotate-45 group-[.active]:-translate-y-2"
        ></span>
      </button>
    </div>
  </div>
</nav>

<!-- Mobile Menu Drawer & Backdrop -->
<div
  id="mobile-menu-backdrop"
  class="fixed inset-0 bg-background/60 backdrop-blur-md z-60 md:hidden opacity-0 pointer-events-none transition-opacity duration-500"
>
</div>

<div
  id="mobile-menu"
  class="fixed top-0 right-0 bottom-0 w-[85%] max-w-sm bg-background z-70 md:hidden translate-x-full transition-transform duration-500 ease-in-out border-l border-white/5 shadow-2xl"
>
  <!-- Close Button -->
  <button
    id="menu-close"
    class="absolute top-8 right-8 w-10 h-10 flex items-center justify-center focus:outline-none group"
    aria-label="Close Menu"
  >
    <div class="relative w-6 h-6">
      <span
        class="absolute top-1/2 left-0 w-6 h-0.5 bg-white rotate-45 -translate-y-1/2 transition-all duration-300 group-hover:bg-accent"
      ></span>
      <span
        class="absolute top-1/2 left-0 w-6 h-0.5 bg-white -rotate-45 -translate-y-1/2 transition-all duration-300 group-hover:bg-accent"
      ></span>
    </div>
  </button>

  <div
    class="flex flex-col h-full p-10 pt-32 gap-8 text-xl font-display font-bold tracking-tight"
  >
    <a
      href="/#about"
      class="mobile-link opacity-0 translate-x-4 transition-all duration-500 delay-100 hover:text-accent text-right"
      >About</a
    >
    <a
      href="/#services"
      class="mobile-link opacity-0 translate-x-4 transition-all duration-500 delay-200 hover:text-accent text-right"
      >Services</a
    >
    <a
      href="/#portfolio"
      class="mobile-link opacity-0 translate-x-4 transition-all duration-500 delay-300 hover:text-accent text-right"
      >Works</a
    >
    <a
      href="/blog"
      class="mobile-link opacity-0 translate-x-4 transition-all duration-500 delay-400 hover:text-accent text-right"
      >Blog</a
    >
    <div class="flex justify-end">
      <a
        href="/#contact"
        class="mobile-link px-8 py-4 rounded-full bg-accent text-background text-sm font-black uppercase tracking-widest opacity-0 translate-x-4 transition-all duration-500 delay-500"
      >
        Let's Talk
      </a>
    </div>
  </div>
</div>

<script>
  const menuToggle = document.getElementById("menu-toggle");
  const menuClose = document.getElementById("menu-close");
  const mobileMenu = document.getElementById("mobile-menu");
  const backdrop = document.getElementById("mobile-menu-backdrop");
  const mobileLinks = document.querySelectorAll(".mobile-link");
  let isMenuOpen = false;

  function toggleMenu() {
    isMenuOpen = !isMenuOpen;

    // Toggle button state
    menuToggle?.classList.toggle("active", isMenuOpen);

    // Toggle drawer and backdrop visibility
    if (isMenuOpen) {
      mobileMenu?.classList.remove("translate-x-full");
      backdrop?.classList.remove("opacity-0", "pointer-events-none");
      backdrop?.classList.add("opacity-100", "pointer-events-auto");

      // Animate links in
      mobileLinks.forEach((link) => {
        link.classList.remove("opacity-0", "translate-x-4");
        link.classList.add("opacity-100", "translate-x-0");
      });

      // Lock scroll
      document.body.style.overflow = "hidden";
    } else {
      mobileMenu?.classList.add("translate-x-full");
      backdrop?.classList.add("opacity-0", "pointer-events-none");
      backdrop?.classList.remove("opacity-100", "pointer-events-auto");

      // Reset links
      mobileLinks.forEach((link) => {
        link.classList.add("opacity-0", "translate-x-4");
        link.classList.remove("opacity-100", "translate-x-0");
      });

      // Unlock scroll
      document.body.style.overflow = "";
    }
  }

  menuToggle?.addEventListener("click", toggleMenu);
  menuClose?.addEventListener("click", toggleMenu);
  backdrop?.addEventListener("click", () => {
    if (isMenuOpen) toggleMenu();
  });

  // Close menu on link click
  mobileLinks.forEach((link) => {
    link.addEventListener("click", () => {
      if (isMenuOpen) toggleMenu();
    });
  });

  // Close menu on escape key
  document.addEventListener("keydown", (e) => {
    if (e.key === "Escape" && isMenuOpen) toggleMenu();
  });
</script>
